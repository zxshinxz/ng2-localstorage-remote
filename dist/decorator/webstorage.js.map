{"version":3,"file":"webstorage.js","sourceRoot":"","sources":["../../src/decorator/webstorage.ts"],"names":[],"mappings":"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","sourcesContent":["const KEY_PREFIX = \"angular2ws\";\n\nexport class WebStorageUtility {\n    static generateStorageKey(key: string): string {\n        return `${KEY_PREFIX}_${key}`\n    }\n\n    static get(storage: Storage, key: string): any {\n        let storageKey = WebStorageUtility.generateStorageKey(key);\n\n        let value = storage.getItem(storageKey);\n\n        return WebStorageUtility.getGettable(value);\n    }\n\n    static set(storage: Storage, key: string, value: any): void {\n        let storageKey = WebStorageUtility.generateStorageKey(key);\n\n        storage.setItem(storageKey, WebStorageUtility.getSettable(value));\n    }\n\n    static remove(storage: Storage, key: string): void {\n        let storageKey = WebStorageUtility.generateStorageKey(key);\n\n        storage.removeItem(storageKey);\n    }\n\n    private static getSettable(value: any): string {\n        return typeof value === \"string\" ? value : JSON.stringify(value);\n    }\n\n    private static getGettable(value: string): any {\n        try {\n            return JSON.parse(value);\n        } catch (e) {\n            return value;\n        }\n    }\n}\n\n// initialization cache\nlet cache = {};\n\nexport function LocalStorage(key?: string) {\n    return (target: Object, propertyName: string): void => {\n        key = key || propertyName;\n\n        let storageKey = WebStorageUtility.generateStorageKey(key);\n        let storedValue = WebStorageUtility.get(localStorage, key);\n\n        Object.defineProperty(target, propertyName, {\n            get: function () {\n                return WebStorageUtility.get(localStorage, key);\n            },\n            set: function (value: any) {\n                if (!cache[key]) {\n                    // first setter handle\n                    if (storedValue === null) {\n                        // if no value in localStorage, set it to initializer\n                        WebStorageUtility.set(localStorage, key, value);\n                    }\n\n                    cache[key] = true;\n                    return;\n                }\n\n                WebStorageUtility.set(localStorage, key, value);\n            },\n        });\n    }\n}\n\nexport function SessionStorage(key?: string) {\n    return WebStorage(sessionStorage, key);\n}\n\n\nexport let WebStorage = createWebStorage;\n\n\nexport function createWebStorage(webStorage: Storage, key: string) {\n    return (target: Object, propertyName: string): void => {\n        key = key || propertyName;\n\n        let storageKey = WebStorageUtility.generateStorageKey(key);\n        let storedValue = WebStorageUtility.get(webStorage, key);\n\n        Object.defineProperty(target, propertyName, {\n            get: function () {\n                return WebStorageUtility.get(webStorage, key);\n            },\n            set: function (value: any) {\n                // if (!cache[key]) {\n                //   // first setter handle\n                //   if (storedValue === null) {\n                //     // if no value in localStorage, set it to initializer\n                //     WebStorageUtility.set(webStorage, key, value);\n                //   }\n                //\n                //   cache[key] = true;\n                //   return;\n                // }\n\n                WebStorageUtility.set(webStorage, key, value);\n            },\n        });\n\n    }\n}\n"]}